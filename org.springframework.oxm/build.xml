<?xml version="1.0" encoding="UTF-8"?>
<project name="org.springframework.oxm" xmlns:ivy="antlib:org.apache.ivy.ant">
	<property file="${basedir}/../build.properties"/>
	<import file="${basedir}/../build-spring-framework/package-bundle.xml"/>
	<import file="${basedir}/../spring-build/standard/default.xml"/>

	<property name="schema" value="${basedir}/src/test/resources/org/springframework/oxm/flight.xsd"/>

	<macrodef name="test-pre-compile">
		<attribute name="classpath.id"/>
		<attribute name="input.dir"/>
		<attribute name="output.dir"/>
		<attribute name="resources.dir"/>
		<sequential>
			<!-- Castor -->
			<!--
			<ivy:cachepath resolveId="castor.classpath" pathid="castor.classpath"
						   organisation="org.codehaus.castor" module="com.springsource.org.castor" revision="1.2.0"
						   conf="runtime" type="jar" inline="true" log="download-only"/>
			<taskdef name="castor" classname="org.castor.anttask.CastorCodeGenTask"
					 classpathref="castor.classpath"/>
			<castor types="j2" warnings="false" file="${schema}" todir="${basedir}/castor/test"
						   package="org.springframework.oxm.castor"/>
		   -->

			<!-- JAXB2 -->
			<!--
		    <ivy:cachepath resolveId="jaxb.classpath" pathid="jaxb.classpath" organisation="com.sun.xml"
						  module="com.springsource.com.sun.xml.bind" revision="2.1.7"
						  conf="runtime" type="jar" inline="true" log="download-only"/>
			<taskdef name="xjc" classname="com.sun.tools.xjc.XJCTask"
					 classpathref="jaxb.classpath"/>
			<xjc destdir="${basedir}/jaxb/test"
				 package="org.springframework.oxm.jaxb"
				 schema="${schema}">
				<produces dir="${basedir}/jaxb/test" includes="**/*.java"/>
			</xjc>
			-->

			<!-- XMLBeans -->
			<ivy:cachepath resolveId="xmlbeans.classpath" pathid="xmlbeans.classpath" organisation="org.apache.xmlbeans"
						   module="com.springsource.org.apache.xmlbeans" revision="2.4.0"
						   conf="runtime" type="jar" inline="true" log="download-only"/>
			<taskdef name="xmlbeans" classname="org.apache.xmlbeans.impl.tool.XMLBean"
					 classpathref="xmlbeans.classpath"/>
			<xmlbeans schema="${schema}" classgendir="@{output.dir}" classpathref="xmlbeans.classpath" compiler="modern"
					  verbose="false"/>
		</sequential>

	</macrodef>

	<macrodef name="test-post-compile">
		<attribute name="classpath.id"/>
		<attribute name="input.dir"/>
		<attribute name="output.dir"/>
		<attribute name="resources.dir"/>
		<sequential>
			<ivy:cachepath resolveId="jibx.classpath" pathid="jibx.classpath" organisation="net.sourceforge.jibx"
						   module="com.springsource.org.jibx.binding" revision="1.1.5"
						   conf="runtime" type="jar" inline="true" log="download-only"/>
			<taskdef name="jibx-bind" classname="org.jibx.binding.ant.CompileTask" classpathref="jibx.classpath"/>

			<jibx-bind load="true" binding="${basedir}/src/test/resources/org/springframework/oxm/jibx/binding.xml">
				<classpathset dir="@{output.dir}">
					<include name="**/jibx/**/*"/>
				</classpathset>
			</jibx-bind>
		</sequential>
	</macrodef>

</project>
